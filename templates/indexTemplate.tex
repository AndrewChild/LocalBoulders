%% import 'macros.tex' as m
\twocolumn
\VAR{m.chapter_head("Index", unnumbered=True)}
\begin{flushleft}

\needspace{1.5cm}
%% if not 'suppress_routes_alphabetical_index' in book.format_options
\section{Routes Alphabetical}
\begin{center}
\rowcolors{2}{MidnightBlue!10}{white}
\begin{supertabular}{p{0.76\linewidth}p{0.08\linewidth}}
%% for climb in book.climbs.values() | sort(attribute="name")
\VAR{climb.name} \VAR{climb.grade_str} & \pageref{\VAR{climb.ref}:\VAR{climb.item_id}} \\
%% endfor
\end{supertabular}
\end{center}
%% endif

%% if not 'suppress_routes_grade_index' in book.format_options
\needspace{1.5cm}
\section{Routes by grade}
\begin{center}
\rowcolors{2}{MidnightBlue!10}{white}
\begin{supertabular}{p{0.18\linewidth}p{0.13\linewidth}p{0.45\linewidth}p{0.08\linewidth}}
%% for climb in book.climbs.values() | sort(reverse=true, attribute="rating") | sort(attribute="gradeNum")
%% if climb.grade_scale == 'Hueco'
\VAR{climb.rating_LaTeX} \VAR{climb.serious_LaTeX}&\VAR{climb.grade_str}&\VAR{climb.name} & \pageref{\VAR{climb.ref}:\VAR{climb.item_id}} \\
%% endif
%% endfor
%% for climb in book.climbs.values() | sort(reverse=true, attribute="rating") | sort(attribute="gradeNum")
%% if climb.grade_scale == 'YDS'
\VAR{climb.rating_LaTeX}\VAR{climb.serious_LaTeX}&\VAR{climb.grade_str}&\VAR{climb.name} & \pageref{\VAR{climb.ref}:\VAR{climb.item_id}} \\
%% endif
%% endfor
\end{supertabular}
\end{center}
%% endif

%% if not 'suppress_gps_index' in book.format_options
\needspace{1.5cm}
\section{Approximate GPS Locations}
%% for area in book.areas.values()
\subsection{Formations in \VAR{area.name}}
\begin{center}
\rowcolors{2}{MidnightBlue!10}{white}
\begin{supertabular}{p{0.38\linewidth}p{0.5\linewidth}}
%% for formation in area.formations.values() | sort(attribute="name")
%% if formation.gps
%\setbox0=\hbox{\includegraphics[width=0.6\linewidth]{\VAR{formation.paths['qr_o']+'/'+formation.item_id+'_qr.png'}}}% Store image in \box0
%\needspace{\ht0}% Need at least the height of \box0
\VAR{formation.name} & \VAR{"%.5f"|format(formation.latitude)}, \VAR{"%.5f"|format(formation.longitude)} \\
%% endif
%% endfor
\end{supertabular}
\end{center}
%% endfor
%% endif

%% if not 'suppress_first_ascents_index' in book.format_options
\section{Known First Ascents}
%% for climb in book.climbs.values() | sort(attribute="name")
%% if climb.FA
\textbf{\VAR{climb.name}:} \VAR{climb.FA}\\
%% endif
%% endfor
%% endif

%% if not ('suppress_photo_credits_index' in book.format_options) and not ('skip_action_photos' in book.format_options)
%% if book.all_photos
\needspace{1.5cm}
\section{Photo Credits}
\begin{center}
\rowcolors{2}{MidnightBlue!10}{white}
\begin{supertabular}{p{0.52\linewidth}p{0.40\linewidth}}
%# This is extremely jank
%% set ns = namespace(last_credit = '')
%% for photo in book.all_photos | sort(attribute="credit")
%% if photo.credit
%% if photo.credit != ns.last_credit
%% if ns.last_credit != ''
\\
%% endif
\VAR{photo.credit} & \pageref{\VAR{photo.ref}:\VAR{photo.item_id}}%
%% else
, \pageref{\VAR{photo.ref}:\VAR{photo.item_id}}%
%% endif
%% set ns.last_credit = photo.credit
%% endif
%% endfor
\\
\end{supertabular}
\end{center}
%% endif
%% endif

%% if not ('special_thanks' in book.format_options)
%% if book.special_thanks
\needspace{1.5cm}
\section{Special Thanks}
\begin{center}
\rowcolors{2}{MidnightBlue!10}{white}
\begin{supertabular}{p{0.92\linewidth}}
%% for thank in book.special_thanks
\VAR{thank}\\
%% endfor
\end{supertabular}
\end{center}
%% endif
%% endif
\end{flushleft}
\onecolumn
\clearpage